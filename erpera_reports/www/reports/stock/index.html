{% extends 'erpera_reports/templates/pages/base.html' %}

{% block page_content %}
    <div class="overview-cards">
        <div class="card">
            <div class="card-icon products">üì¶</div>
            <div class="card-value">{{ total_items }}</div>
            <div class="card-label">Total Items</div>
            <p style="color: #dc2626; font-size: 12px; font-weight: 500;">({{ current_fiscal_year }})</p>
        </div>
        <div class="card">
            <div class="card-icon orders">üè™</div>
            <div class="card-value">{{ total_warehouses }} </div>
            <div class="card-label">Total Warehouses</div>
            <p style="color: #dc2626; font-size: 12px; font-weight: 500;">({{ current_fiscal_year }})</p>
        </div>
        <div class="card">
            <div class="card-icon stock">üìä</div>
            <div class="card-value">{{ total_stock_value }} </div>
            <div class="card-label">Total Stock Value</div>
            <p style="color: #dc2626; font-size: 12px; font-weight: 500;">({{ current_fiscal_year }})</p>
        </div>
        <div class="card">
            <div class="card-icon out-of-stock">‚ö†Ô∏è</div>
            <div class="card-value">{{ low_stock_items }} </div>
            <div class="card-label">Low Stock Items</div>
            <p style="color: #dc2626; font-size: 12px; font-weight: 500;">({{ current_month }})</p>
        </div>
    </div>

    <div class="section-container">
        <h2 class="section-title">Total Stock</h2>
        <div class="charts-row">
            {% set chart_id = 'warehouseWiseStock' %}
            {% set title = 'Warehouse Wise Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_warehouse_wise_stock' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'companyWiseStock' %}
            {% set title = 'Company Wise Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_company_wise_stock' %}
            {% set filters = [
                { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
                { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
                { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'stockSummary' %}
            {% set title = 'Stock Summary' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_stock_summary' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <div class="section-container">
        <h2 class="section-title">Consolidated Total Stock</h2>
        <div class="charts-row">
            {% set chart_id = 'consolidatedTotalStock' %}
            {% set title = 'Consolidated Total Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_consolidated_stock' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'entityWiseStock' %}
            {% set title = 'Entity Wise Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_entity_wise_stock' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'consolidatedExpiryStock' %}
            {% set title = 'Consolidated Expiry Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_consolidated_expiry_stock' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <div class="section-container">
        <h2 class="section-title">Expiry Stock</h2>
        <div class="charts-row">
            {% set chart_id = 'warehouseWiseExpiryStock' %}
            {% set title = 'Warehouse Wise Expiry Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_warehouse_wise_expiry_stock' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'companyWiseExpiryStock' %}
            {% set title = 'Company Wise Expiry Stock' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_company_wise_expiry_stock' %}
            {% set filters = [
                { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
                { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
                { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'expiryStockSummary' %}
            {% set title = 'Expiry Stock Summary' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_expiry_stock_summary' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <!-- Stock Transfer Opportunities Section -->
    <div class="section-container">
        <h2 class="section-title">Stock Transfer Opportunities</h2>
        <div class="charts-row">
            {% set chart_id = 'expiryDemandComparison' %}
            {% set title = 'Comparison Chart - Expiry vs Demand' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_expiry_demand_comparison' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <!-- Consolidate Expired Items Section -->
    <div class="section-container">
        <h2 class="section-title">Consolidate Expired Items</h2>
        <div class="charts-row">
            {% set chart_id = 'consolidatedExpiredItems' %}
            {% set title = 'All Company Expired Stock - Bar Chart' %}
            {% set backgroundColor = '#dc2626' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_consolidated_expired_items' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <!-- In & Out Quantity Movement Section -->
    <div class="section-container">
        <h2 class="section-title">In & Out Quantity Movement</h2>
        <div class="charts-row">
            {% set chart_id = 'branchWiseInOutQuantity' %}
            {% set title = 'Branch Wise In & Out Quantity Movement' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_branch_wise_in_out_quantity' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'companyWiseInOutQuantity' %}
            {% set title = 'Company Wise In & Out Quantity Movement' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_company_wise_in_out_quantity' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}

            {% set chart_id = 'consolidateInOutQuantity' %}
            {% set title = 'Consolidate In & Out Quantity - All Companies & Branches' %}
            {% set backgroundColor = '#7c3aed' %}
            {% set chart_type = 'bar' %}
            {% set width = 12 %}
            {% set data_url = 'erpera_reports.stock.get_consolidate_in_out_quantity' %}
            {% set filters = [
              { "label": "From Date", "fieldtype": "Date", "fieldname": "from_date" },
              { "label": "To Date", "fieldtype": "Date", "fieldname": "to_date" },
              { "label": "Item", "fieldtype": "Select", "fieldname": "item", "options": item_list },
              { "label": "Item Group", "fieldtype": "Select", "fieldname": "item_group", "options": item_group_list },
              { "label": "Company", "fieldtype": "Select", "fieldname": "company", "options": company_list },
              { "label": "Warehouse", "fieldtype": "Select", "fieldname": "warehouse", "options": warehouse_list }
            ] %}
            {% include "erpera_reports/templates/includes/bar.html" %}
        </div>
    </div>

    <!-- Space for future sections -->

{% endblock %}

<style>
.section-container {
    margin: 2rem 0;
    padding: 1rem;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.section-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #1a1a1a;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #7c3aed;
}

.charts-row {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
}
</style>
